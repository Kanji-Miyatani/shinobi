{"ast":null,"code":"import _toConsumableArray from\"C:/Users/k-miyatani/Pub/NEETsInCompanyWeb/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/Users/k-miyatani/Pub/NEETsInCompanyWeb/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import io from'socket.io-client';import{useState,useEffect,useRef}from'react';import{useSelector}from'react-redux';import DressInput from'@mui/material/TextField';import AvatarIcon from'../components/AvatorIcon';import Button from'@mui/material/Button';import List from'@mui/material/List';import ListItem from'@mui/material/ListItem';import ListItemButton from'@mui/material/ListItemButton';import ListItemText from'@mui/material/ListItemText';import ListItemAvatar from'@mui/material/ListItemAvatar';import Checkbox from'@mui/material/Checkbox';import Avatar from'@mui/material/Avatar';import store from'../store/store.js';import'../style/ChatRoom.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ChatRoom(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),messageList=_useState2[0],setMessageList=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),message=_useState4[0],setMessage=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),flagShowChat=_useState6[0],setFlagShowChat=_useState6[1];var socketref=useRef();function thisfocus(){document.getElementById('message').focus();setFlagShowChat(true);};function thisblur(){setFlagShowChat(false);};//送信イベント\nfunction submitEvent(e){e.preventDefault();if(socketref!==undefined){//ソケットを通してset_nameイベントを発火する\nvar avator=store.getState().loginInfoReducer.avatorType;var name=store.getState().loginInfoReducer.name;socketref.current.emit('message',{avatorType:avator,name:name,message:message});document.getElementById('message').value='';setMessage('');}};useEffect(function(){socketref.current=io();socketref.current.on('receive',function(msg){console.log('receive');var message=msg.message,name=msg.name,avatorType=msg.avatorType;setMessageList(function(list){return[].concat(_toConsumableArray(list),[{name:name,message:message,avatorType:avatorType}]);});});return function(){socketref.current.disconnect();};},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"ChatRoom\",onBlur:function onBlur(){thisblur();},onFocus:function onFocus(){thisfocus();},onClick:function onClick(){if(!flagShowChat){thisfocus();}},style:flagShowChat?{opacity:'1.0'}:{opacity:'0.25'},children:[/*#__PURE__*/_jsx(\"header\",{className:\"ChatRoom-header\",id:\"Chat-DispArea\",children:/*#__PURE__*/_jsx(List,{dense:true,sx:{width:'100%',bgcolor:'rgba(255, 255, 255, 0.1)'},children:messageList.slice(messageList.length-13<0?0:messageList.length-13).map(function(value,id){var labelId=\"checkbox-list-secondary-label-\".concat(value);return/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemAvatar,{children:/*#__PURE__*/_jsx(AvatarIcon,{avatorType:value.avatorType,height:\"36px\"})}),/*#__PURE__*/_jsx(ListItemText,{id:labelId,primary:\"\".concat(value.name,\" > \").concat(value.message)})]},id);})})}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:function onSubmit(e){submitEvent(e);},autoComplete:\"off\",children:[/*#__PURE__*/_jsx(DressInput,{label:\"\",variant:\"standard\",className:\"input--\",autoComplete:\"off\",id:\"message\",type:\"text\",onChange:function onChange(e){return setMessage(e.target.value);}}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",type:\"submit\",children:\"\\u9001\\u4FE1\"})]})]});}export default ChatRoom;","map":{"version":3,"sources":["C:/Users/k-miyatani/Pub/NEETsInCompanyWeb/frontend/src/components/ChatRoom.js"],"names":["io","useState","useEffect","useRef","useSelector","DressInput","AvatarIcon","Button","List","ListItem","ListItemButton","ListItemText","ListItemAvatar","Checkbox","Avatar","store","ChatRoom","messageList","setMessageList","message","setMessage","flagShowChat","setFlagShowChat","socketref","thisfocus","document","getElementById","focus","thisblur","submitEvent","e","preventDefault","undefined","avator","getState","loginInfoReducer","avatorType","name","current","emit","value","on","msg","console","log","list","disconnect","opacity","width","bgcolor","slice","length","map","id","labelId","target"],"mappings":"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","sourcesContent":["import io from 'socket.io-client';\r\nimport { useState ,useEffect,useRef} from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport DressInput from '@mui/material/TextField';\r\nimport AvatarIcon from '../components/AvatorIcon';\r\nimport Button from '@mui/material/Button';\r\nimport List from '@mui/material/List';\r\nimport ListItem from '@mui/material/ListItem';\r\nimport ListItemButton from '@mui/material/ListItemButton';\r\nimport ListItemText from '@mui/material/ListItemText';\r\nimport ListItemAvatar from '@mui/material/ListItemAvatar';\r\nimport Checkbox from '@mui/material/Checkbox';\r\nimport Avatar from '@mui/material/Avatar';\r\nimport store from '../store/store.js';\r\nimport '../style/ChatRoom.css'\r\nfunction ChatRoom() {\r\n    const [messageList,setMessageList] = useState([]);\r\n    const [message, setMessage] = useState('');\r\n    const [flagShowChat, setFlagShowChat] = useState(false);\r\n    const socketref = useRef();\r\n    function thisfocus(){\r\n        document.getElementById('message').focus();\r\n        setFlagShowChat(true);\r\n    };\r\n    function thisblur(){\r\n        setFlagShowChat(false);\r\n    };\r\n    //送信イベント\r\n    function submitEvent(e){\r\n        e.preventDefault();\r\n      if (socketref !== undefined){\r\n        //ソケットを通してset_nameイベントを発火する\r\n        const avator = store.getState().loginInfoReducer.avatorType;\r\n        const name = store.getState().loginInfoReducer.name;\r\n        socketref.current.emit('message',{avatorType:avator,name:name,message:message});\r\n        document.getElementById('message').value='';\r\n        setMessage('');\r\n      }\r\n    };\r\n    useEffect(()=>{\r\n        socketref.current=io();\r\n        socketref.current.on('receive',(msg)=>{\r\n            console.log('receive');\r\n            const {message,name,avatorType} = msg;\r\n                setMessageList(list=>[...list, {\r\n                    name:name,\r\n                    message:message,\r\n                    avatorType:avatorType\r\n                }]);\r\n        });\r\n        return ()=>{socketref.current.disconnect()};\r\n    },[]);\r\n \r\n  return (\r\n    <div className=\"ChatRoom\" \r\n    onBlur={()=>{thisblur()}}\r\n    onFocus={()=>{thisfocus()}} \r\n    onClick={()=>{if(!flagShowChat){\r\n      thisfocus()\r\n    }}} style={flagShowChat?{opacity:'1.0'}:{opacity:'0.25'}}>\r\n      <header className=\"ChatRoom-header\" id=\"Chat-DispArea\">\r\n       <List dense sx={{ width: '100%', bgcolor:'rgba(255, 255, 255, 0.1)' }}>\r\n      {messageList.slice(messageList.length-13<0?0:messageList.length-13).map((value,id) => {\r\n        const labelId = `checkbox-list-secondary-label-${value}`;\r\n        return (\r\n          <ListItem\r\n            key={id}>\r\n            <ListItemAvatar>\r\n             <AvatarIcon avatorType={value.avatorType} height=\"36px\" />\r\n            </ListItemAvatar>\r\n            <ListItemText id={labelId} primary={`${value.name} > ${value.message}`}  />\r\n          </ListItem>\r\n        );\r\n      })}\r\n    </List>\r\n    </header>\r\n    <form onSubmit={(e)=>{submitEvent(e);}} autoComplete=\"off\">\r\n        <DressInput label=\"\" variant=\"standard\" className=\"input--\" autoComplete=\"off\" id=\"message\" type=\"text\" onChange={e => setMessage(e.target.value)} />\r\n        <Button variant=\"outlined\" type=\"submit\">送信\r\n        </Button>\r\n    </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ChatRoom;\r\n"]},"metadata":{},"sourceType":"module"}